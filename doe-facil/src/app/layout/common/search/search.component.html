<!-- Basic search -->
<ng-container *ngIf="appearance === 'basic'">
    <div class="flex-auto w-full sm:min-w-80" *ngIf="appearance === 'basic'">
        <mat-form-field
            class="fuse-mat-dense fuse-mat-rounded w-full min-w-100"
            subscriptSizing="dynamic">
            <mat-icon
                class="icon-size-5"
                matPrefix
                [svgIcon]="'heroicons_solid:search'"></mat-icon>
            <input
            matInput 
            [formControl]="searchControl"
            [matAutocomplete]="matAutocomplete"
            [placeholder]="'Pesquise aqui...'"
            (keydown)="onKeydown($event)">
        </mat-form-field>
        <mat-autocomplete
                class="max-h-128 mt-1 rounded"
                [autoSelectActiveOption]="true"
                [disableRipple]="true"
                #matAutocomplete="matAutocomplete">
                <mat-option
                    class="py-0 px-6 text-md pointer-events-none text-secondary bg-transparent"
                    *ngIf="resultSets && !resultSets.length">
                    No results found!
                </mat-option>
                <ng-container *ngFor="let resultSet of resultSets; trackBy: trackByFn">
                    <mat-optgroup class="flex items-center mt-2 px-2">
                        <span class="text-sm font-semibold tracking-wider text-secondary">{{resultSet.label.toUpperCase()}}</span>
                    </mat-optgroup>
                    <ng-container *ngFor="let result of resultSet.results; trackBy: trackByFn">
                        <mat-option
                            class="group relative mb-1 py-0 px-6 text-md rounded-md hover:bg-gray-100 dark:hover:bg-hover"
                            [routerLink]="result.link"
                            [value]="result.value">
                            <!-- Contacts -->
                            <ng-container *ngIf="resultSet.id === 'contacts'">
                                <ng-container *ngTemplateOutlet="contactResult; context: {$implicit: result}"></ng-container>
                            </ng-container>
                            <!-- Pages -->
                            <ng-container *ngIf="resultSet.id === 'pages'">
                                <ng-container *ngTemplateOutlet="pageResult; context: {$implicit: result}"></ng-container>
                            </ng-container>
                            <!-- Tasks -->
                            <ng-container *ngIf="resultSet.id === 'tasks'">
                                <ng-container *ngTemplateOutlet="taskResult; context: {$implicit: result}"></ng-container>
                            </ng-container>
                        </mat-option>
                    </ng-container>
                </ng-container>
        </mat-autocomplete>
    </div>
</ng-container>

<!-- Page result template -->
<ng-template
    #pageResult
    let-result>
    <div class="flex flex-col">
        <div
            class="truncate leading-normal"
            [innerHTML]="result.title"></div>
        <div class="truncate leading-normal text-sm text-secondary">
            {{result.link}}
        </div>
    </div>
</ng-template>

<!-- Task result template -->
<ng-template
    #taskResult
    let-result>
    <div class="flex items-center">
        <ng-container *ngIf="result.completed">
            <mat-icon
                class="mr-0 text-primary dark:text-primary-400"
                [svgIcon]="'heroicons_outline:check-circle'"></mat-icon>
        </ng-container>
        <ng-container *ngIf="!result.completed">
            <mat-icon
                class="mr-0 text-hint"
                [svgIcon]="'heroicons_outline:check-circle'"></mat-icon>
        </ng-container>
        <div
            class="ml-3 truncate leading-normal"
            [ngClass]="{'line-through text-hint': result.completed}"
            [innerHTML]="result.title"></div>
    </div>
</ng-template>
